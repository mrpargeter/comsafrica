## platf morph ##
plat_morph_data_a<-categ_data_a %>%
select(new_flake_id,analyst_id,platfmorph) %>%
na.omit
plat_morph_data_a<-plat_morph_data_a[as.numeric(ave(plat_morph_data_a$new_flake_id,
plat_morph_data_a$new_flake_id,
FUN=length)) >= 6, ]
plat_morph_data_a_krip_a<- plat_morph_data_a %>%
mutate(plat_morph_dummy=unclass(platfmorph)) %>%
select(-platfmorph) %>%
spread(analyst_id, plat_morph_dummy) %>%
select(-new_flake_id) %>%
as.matrix()
v<-gwet.ac1.raw(plat_morph_data_a_krip_a)$est
## platf lip ##
plat_lip_data_a<-categ_data_a %>%
select(new_flake_id,analyst_id,platflipp) %>%
na.omit
plat_lip_data_a<-plat_lip_data_a[as.numeric(ave(plat_lip_data_a$new_flake_id,
plat_lip_data_a$new_flake_id,
FUN=length)) >=6, ]
plat_lip_data_a_krip_a<- plat_lip_data_a %>%
mutate(plat_lip_dummy=unclass(platflipp)) %>%
select(-platflipp) %>%
spread(analyst_id, plat_lip_dummy) %>%
select(-new_flake_id) %>%
as.matrix()
w<-gwet.ac1.raw(plat_lip_data_a_krip_a)$est
## bulb ##
plat_bulb_data_a<-categ_data_a %>%
select(new_flake_id,analyst_id,bulb) %>%
na.omit
plat_bulb_data_a<-plat_bulb_data_a[as.numeric(ave(plat_bulb_data_a$new_flake_id,
plat_bulb_data_a$new_flake_id,
FUN=length)) >=6, ]
plat_bulb_data_a_krip_a<- plat_bulb_data_a %>%
mutate(plat_bulb_dummy=unclass(bulb)) %>%
select(-bulb) %>%
spread(analyst_id, plat_bulb_dummy) %>%
select(-new_flake_id) %>%
as.matrix()
x<-gwet.ac1.raw(plat_bulb_data_a_krip_a)$est
## Shattbulb ##
plat_shattbulb_data_a<-categ_data_a %>%
select(new_flake_id,analyst_id,shattbulb) %>%
na.omit
plat_shattbulb_data_a<-plat_shattbulb_data_a[as.numeric(ave(plat_shattbulb_data_a$new_flake_id,
plat_shattbulb_data_a$new_flake_id,
FUN=length)) >=6, ]
plat_shattbulb_data_a_krip_a<- plat_shattbulb_data_a %>%
mutate(plat_shattbulb_dummy=unclass(shattbulb)) %>%
select(-shattbulb) %>%
spread(analyst_id, plat_shattbulb_dummy) %>%
select(-new_flake_id) %>%
as.matrix()
y<-gwet.ac1.raw(plat_shattbulb_data_a_krip_a)$est
## initiation ##
plat_initiation_data_a<-categ_data_a %>%
select(new_flake_id,analyst_id,initiation) %>%
na.omit
plat_initiation_data_a<-plat_initiation_data_a[as.numeric(ave(plat_initiation_data_a$new_flake_id,
plat_initiation_data_a$new_flake_id,
FUN=length)) >=6, ]
plat_initiation_data_a_krip_a<- plat_initiation_data_a %>%
mutate(initiation_dummy=unclass(initiation)) %>%
select(-initiation) %>%
spread(analyst_id, initiation_dummy) %>%
select(-new_flake_id) %>%
as.matrix()
z<-gwet.ac1.raw(plat_initiation_data_a_krip_a)$est
## ventr_plane_form ##
ventr_plane_form_data_a<-categ_data_a %>%
select(new_flake_id,analyst_id,ventr_plane_form) %>%
na.omit
ventr_plane_form_data_a<-ventr_plane_form_data_a[as.numeric(ave(ventr_plane_form_data_a$new_flake_id,
ventr_plane_form_data_a$new_flake_id,
FUN=length)) >=6, ]
ventr_plane_form_data_a_krip_a<- ventr_plane_form_data_a %>%
mutate(ventr_plane_form_dummy=unclass(ventr_plane_form)) %>%
select(-ventr_plane_form) %>%
spread(analyst_id, ventr_plane_form_dummy) %>%
select(-new_flake_id) %>%
as.matrix()
aa<-gwet.ac1.raw(ventr_plane_form_data_a_krip_a)$est
## Section ##
section_data_a<-categ_data_a %>%
select(new_flake_id,analyst_id,section) %>%
na.omit
section_data_a<-section_data_a[as.numeric(ave(section_data_a$new_flake_id,
section_data_a$new_flake_id,
FUN=length)) >=6, ]
section_data_a_krip_a<- section_data_a %>%
mutate(section_dummy=unclass(section)) %>%
select(-section) %>%
spread(analyst_id, section_dummy) %>%
select(-new_flake_id) %>%
as.matrix()
bb<-gwet.ac1.raw(section_data_a_krip_a)$est
## Lateral edge type ##
latedge_data_a<-categ_data_a %>%
select(new_flake_id,analyst_id,latedgetype) %>%
na.omit
latedge_data_a<-latedge_data_a[as.numeric(ave(latedge_data_a$new_flake_id,
latedge_data_a$new_flake_id,
FUN=length)) >=6, ]
latedge_data_a_krip_a<- latedge_data_a %>%
mutate(latedge_dummy=unclass(latedgetype)) %>%
select(-latedgetype) %>%
spread(analyst_id, latedge_dummy) %>%
select(-new_flake_id) %>%
as.matrix()
cc<-gwet.ac1.raw(latedge_data_a_krip_a)$est
## Flake termination ##
flaketerm_data_a<-categ_data_a %>%
select(new_flake_id,analyst_id,flaketerm) %>%
na.omit
flaketerm_data_a<-flaketerm_data_a[as.numeric(ave(flaketerm_data_a$new_flake_id,
flaketerm_data_a$new_flake_id,
FUN=length)) >=6, ]
flaketerm_data_a_krip_a<- flaketerm_data_a %>%
mutate(flaketerm_dummy=unclass(flaketerm)) %>%
select(-flaketerm) %>%
spread(analyst_id, flaketerm_dummy) %>%
select(-new_flake_id) %>%
as.matrix()
dd<-gwet.ac1.raw(flaketerm_data_a_krip_a)$est
## Kombewa
kombewa_data_a<-categ_data_a %>%
select(new_flake_id,analyst_id,kombewa) %>%
na.omit
kombewa_data_a<-kombewa_data_a[as.numeric(ave(kombewa_data_a$new_flake_id,
kombewa_data_a$new_flake_id,
FUN=length)) > 4, ]
kombewa_data_a_krip_a<- kombewa_data_a %>%
mutate(kombewa_dummy=unclass(kombewa)) %>%
select(-kombewa) %>%
spread(analyst_id, kombewa_dummy) %>%
select(-new_flake_id) %>%
as.matrix()
ee<-gwet.ac1.raw(kombewa_data_a_krip_a)$est
## Distal plan form
distplanform_data_a<-categ_data_a %>%
select(new_flake_id,analyst_id,distplanform) %>%
na.omit
distplanform_data_a<-distplanform_data_a[as.numeric(ave(distplanform_data_a$new_flake_id,
distplanform_data_a$new_flake_id,
FUN=length)) > 4, ]
distplanform_data_a_krip_a<- distplanform_data_a %>%
mutate(distplanform_dummy=unclass(distplanform)) %>%
select(-distplanform) %>%
spread(analyst_id, distplanform_dummy) %>%
select(-new_flake_id) %>%
as.matrix()
ff<-gwet.ac1.raw(distplanform_data_a_krip_a)$est
## collate gwet results
gwet_data<-rbind(q,r,s,t,u,v,w,x,y,z,aa,bb,cc,dd,ee,ff)
var_names<-c("reduction_system","flake_form","completeness","platform_cortex",
"scar_directionality", "platform_morphology", "platform_lipping",
"bulb","shattered_bulb", "initiation","ventral_plan_form","cross_section_shape",
"lateral_edge_shape","flake_termination","Kombewa","distal_plan_form")
## collate gwet results
gwet_data_a<-rbind(q,r,s,t,u,v,w,x,y,z,aa,bb,cc,dd,ee,ff)
var_names<-c("reduction_system","flake_form","completeness","platform_cortex",
"scar_directionality", "platform_morphology", "platform_lipping",
"bulb","shattered_bulb", "initiation","ventral_plan_form","cross_section_shape",
"lateral_edge_shape","flake_termination","Kombewa","distal_plan_form")
View(gwet_data_a)
gwet_data_merged<-cbind(gwet_data_a,var_names) %>%
select(c(var_names,coeff.val)) %>%
mutate(assemblage_code=rep("a",times=length(var_names)),
across(where(is.numeric), ~ round(., 2))) %>%
arrange(-coeff.val)
gwet_data_merged_a<-cbind(gwet_data_a,var_names) %>%
select(c(var_names,coeff.val)) %>%
mutate(assemblage_code=rep("a",times=length(var_names)),
across(where(is.numeric), ~ round(., 2))) %>%
arrange(-coeff.val)
View(gwet_data_merged_a)
categ_data_b<-comsafrica_data_cat_data %>% filter(assemblage_code=="chert_condition_B")
red_syst_data_b<-categ_data_b %>%
select(new_flake_id,analyst_id,red_syst) %>%
na.omit
# delete flake #'s with < 4 observations
red_syst_data_b<-red_syst_data_b[as.numeric(ave(red_syst_data_b$new_flake_id,
red_syst_data_b$new_flake_id,
FUN=length)) >= 6, ]
# reclass cat variables into numeric values for the krip stat
red_syst_data_b_krip_b<- red_syst_data_b %>%
mutate(red_sys_dummy=unclass(red_syst)) %>%
select(-red_syst) %>%
spread(analyst_id,red_sys_dummy) %>%
select(-new_flake_id) %>%
as.matrix()
gg<-gwet.ac1.raw(red_syst_data_b_krip_b)$est
## flake form ##
flake_form_data_b<-categ_data_b %>%
select(new_flake_id,analyst_id,flk_form) %>%
na.omit
# delete flake #'s with < 4 observations
flake_form_data_b<-flake_form_data_b[as.numeric(ave(flake_form_data_b$new_flake_id,
flake_form_data_b$new_flake_id,
FUN=length)) >= 6, ]
# reclass cat variables into numeric values for the krip stat
flake_form_data_b_krip_b<- flake_form_data_b %>%
mutate(flk_form=as.factor(flk_form),
flk_form_dummy=unclass(flk_form)) %>%
select(-flk_form) %>%
spread(analyst_id, flk_form_dummy) %>%
select(-new_flake_id) %>%
as.matrix()
hh<-gwet.ac1.raw(flake_form_data_b_krip_b)$est
## completeness ##
completeness_data_b<-categ_data_b %>%
select(new_flake_id,analyst_id,completeness) %>%
na.omit #delete coding episodes with no data
# delete flake #'s with < 4 observations
completeness_data_b<-completeness_data_b[as.numeric(ave(completeness_data_b$new_flake_id,
completeness_data_b$new_flake_id,
FUN=length)) >= 6, ]
# reclass cat variables into numeric values for the krip stat
completeness_data_b_krip_b<- completeness_data_b %>%
mutate(completeness=as.factor(completeness),
completeness_dummy=unclass(completeness)) %>%
select(-completeness) %>%
spread(analyst_id, completeness_dummy) %>%
select(-new_flake_id) %>%
as.matrix()
ii<-gwet.ac1.raw(completeness_data_b_krip_b)$est
## platform cortex ##
platform_cortex_data_b<-categ_data_b %>%
select(new_flake_id,analyst_id,platform_cortex) %>%
na.omit
platform_cortex_data_b<-platform_cortex_data_b[as.numeric(ave(platform_cortex_data_b$new_flake_id,
platform_cortex_data_b$new_flake_id,
FUN=length)) >= 6, ]
platform_cortex_data_b_krip_b<- platform_cortex_data_b %>%
mutate(platform_cortex=as.factor(platform_cortex),
platform_cortex_dummy=unclass(platform_cortex)) %>%
select(-platform_cortex) %>%
spread(analyst_id, platform_cortex_dummy) %>%
select(-new_flake_id) %>%
as.matrix()
jj<-gwet.ac1.raw(platform_cortex_data_b_krip_b)$est
## scar directions ##
directionality_data_b<-categ_data_b %>%
select(new_flake_id,analyst_id,directionality) %>%
na_if("") %>% #delete coding episodes with no data
na.omit
directionality_data_b<-directionality_data_b[as.numeric(ave(directionality_data_b$new_flake_id,
directionality_data_b$new_flake_id,
FUN=length)) >= 6, ]
directionality_data_b_krip_b<- directionality_data_b %>%
mutate(directionality_dummy=unclass(directionality)) %>%
select(-directionality) %>%
spread(analyst_id, directionality_dummy) %>%
select(-new_flake_id) %>%
as.matrix()
kk<-gwet.ac1.raw(directionality_data_b_krip_b)$est
## platf morph ##
plat_morph_data_b<-categ_data_b %>%
select(new_flake_id,analyst_id,platfmorph) %>%
na.omit
plat_morph_data_b<-plat_morph_data_b[as.numeric(ave(plat_morph_data_b$new_flake_id,
plat_morph_data_b$new_flake_id,
FUN=length)) >= 6, ]
plat_morph_data_b_krip_b<- plat_morph_data_b %>%
mutate(plat_morph_dummy=unclass(platfmorph)) %>%
select(-platfmorph) %>%
spread(analyst_id, plat_morph_dummy) %>%
select(-new_flake_id) %>%
as.matrix()
ll<-gwet.ac1.raw(plat_morph_data_b_krip_b)$est
## platf lip ##
plat_lip_data_b<-categ_data_b %>%
select(new_flake_id,analyst_id,platflipp) %>%
na.omit
plat_lip_data_b<-plat_lip_data_b[as.numeric(ave(plat_lip_data_b$new_flake_id,
plat_lip_data_b$new_flake_id,
FUN=length)) >=6, ]
plat_lip_data_b_krip_b<- plat_lip_data_b %>%
mutate(plat_lip_dummy=unclass(platflipp)) %>%
select(-platflipp) %>%
spread(analyst_id, plat_lip_dummy) %>%
select(-new_flake_id) %>%
as.matrix()
mm<-gwet.ac1.raw(plat_lip_data_b_krip_b)$est
## bulb ##
plat_bulb_data_b<-categ_data_b %>%
select(new_flake_id,analyst_id,bulb) %>%
na.omit
plat_bulb_data_b<-plat_bulb_data_b[as.numeric(ave(plat_bulb_data_b$new_flake_id,
plat_bulb_data_b$new_flake_id,
FUN=length)) >=6, ]
plat_bulb_data_b_krip_b<- plat_bulb_data_b %>%
mutate(plat_bulb_dummy=unclass(bulb)) %>%
select(-bulb) %>%
spread(analyst_id, plat_bulb_dummy) %>%
select(-new_flake_id) %>%
as.matrix()
nn<-gwet.ac1.raw(plat_bulb_data_b_krip_b)$est
## Shattbulb ##
plat_shattbulb_data_b<-categ_data_b %>%
select(new_flake_id,analyst_id,shattbulb) %>%
na.omit
plat_shattbulb_data_b<-plat_shattbulb_data_b[as.numeric(ave(plat_shattbulb_data_b$new_flake_id,
plat_shattbulb_data_b$new_flake_id,
FUN=length)) >=6, ]
plat_shattbulb_data_b_krip_b<- plat_shattbulb_data_b %>%
mutate(plat_shattbulb_dummy=unclass(shattbulb)) %>%
select(-shattbulb) %>%
spread(analyst_id, plat_shattbulb_dummy) %>%
select(-new_flake_id) %>%
as.matrix()
oo<-gwet.ac1.raw(plat_shattbulb_data_b_krip_b)$est
## initiation ##
plat_initiation_data_b<-categ_data_b %>%
select(new_flake_id,analyst_id,initiation) %>%
na.omit
plat_initiation_data_b<-plat_initiation_data_b[as.numeric(ave(plat_initiation_data_b$new_flake_id,
plat_initiation_data_b$new_flake_id,
FUN=length)) >=6, ]
plat_initiation_data_b_krip_b<- plat_initiation_data_b %>%
mutate(initiation_dummy=unclass(initiation)) %>%
select(-initiation) %>%
spread(analyst_id, initiation_dummy) %>%
select(-new_flake_id) %>%
as.matrix()
pp<-gwet.ac1.raw(plat_initiation_data_b_krip_b)$est
## ventr_plane_form ##
ventr_plane_form_data_b<-categ_data_b %>%
select(new_flake_id,analyst_id,ventr_plane_form) %>%
na.omit
ventr_plane_form_data_b<-ventr_plane_form_data_b[as.numeric(ave(ventr_plane_form_data_b$new_flake_id,
ventr_plane_form_data_b$new_flake_id,
FUN=length)) >=6, ]
ventr_plane_form_data_b_krip_b<- ventr_plane_form_data_b %>%
mutate(ventr_plane_form_dummy=unclass(ventr_plane_form)) %>%
select(-ventr_plane_form) %>%
spread(analyst_id, ventr_plane_form_dummy) %>%
select(-new_flake_id) %>%
as.matrix()
qq<-gwet.ac1.raw(ventr_plane_form_data_b_krip_b)$est
## Section ##
section_data_b<-categ_data_b %>%
select(new_flake_id,analyst_id,section) %>%
na.omit
section_data_b<-section_data_b[as.numeric(ave(section_data_b$new_flake_id,
section_data_b$new_flake_id,
FUN=length)) >=6, ]
section_data_b_krip_b<- section_data_b %>%
mutate(section_dummy=unclass(section)) %>%
select(-section) %>%
spread(analyst_id, section_dummy) %>%
select(-new_flake_id) %>%
as.matrix()
rr<-gwet.ac1.raw(section_data_b_krip_b)$est
## Lateral edge type ##
latedge_data_b<-categ_data_b %>%
select(new_flake_id,analyst_id,latedgetype) %>%
na.omit
latedge_data_b<-latedge_data_b[as.numeric(ave(latedge_data_b$new_flake_id,
latedge_data_b$new_flake_id,
FUN=length)) >=6, ]
latedge_data_b_krip_b<- latedge_data_b %>%
mutate(latedge_dummy=unclass(latedgetype)) %>%
select(-latedgetype) %>%
spread(analyst_id, latedge_dummy) %>%
select(-new_flake_id) %>%
as.matrix()
ss<-gwet.ac1.raw(latedge_data_b_krip_b)$est
## Flake termination ##
flaketerm_data_b<-categ_data_b %>%
select(new_flake_id,analyst_id,flaketerm) %>%
na.omit
flaketerm_data_b<-flaketerm_data_b[as.numeric(ave(flaketerm_data_b$new_flake_id,
flaketerm_data_b$new_flake_id,
FUN=length)) >=6, ]
flaketerm_data_b_krip_b<- flaketerm_data_b %>%
mutate(flaketerm_dummy=unclass(flaketerm)) %>%
select(-flaketerm) %>%
spread(analyst_id, flaketerm_dummy) %>%
select(-new_flake_id) %>%
as.matrix()
tt<-gwet.ac1.raw(flaketerm_data_b_krip_b)$est
## Kombewa
kombewa_data_b<-categ_data_b %>%
select(new_flake_id,analyst_id,kombewa) %>%
na.omit
kombewa_data_b<-kombewa_data_b[as.numeric(ave(kombewa_data_b$new_flake_id,
kombewa_data_b$new_flake_id,
FUN=length)) > 4, ]
kombewa_data_b_krip_b<- kombewa_data_b %>%
mutate(kombewa_dummy=unclass(kombewa)) %>%
select(-kombewa) %>%
spread(analyst_id, kombewa_dummy) %>%
select(-new_flake_id) %>%
as.matrix()
uu<-gwet.ac1.raw(kombewa_data_b_krip_b)$est
## Distal plan form
distplanform_data_b<-categ_data_b %>%
select(new_flake_id,analyst_id,distplanform) %>%
na.omit
distplanform_data_b<-distplanform_data_b[as.numeric(ave(distplanform_data_b$new_flake_id,
distplanform_data_b$new_flake_id,
FUN=length)) > 4, ]
distplanform_data_b_krip_b<- distplanform_data_b %>%
mutate(distplanform_dummy=unclass(distplanform)) %>%
select(-distplanform) %>%
spread(analyst_id, distplanform_dummy) %>%
select(-new_flake_id) %>%
as.matrix()
vv<-gwet.ac1.raw(distplanform_data_b_krip_b)$est
## collate gwet results
gwet_data_a<-rbind(gg,hh,ii,jj,kk,ll,mm,nn,oo,pp,qq,rr,ss,tt,uu,vv)
## collate gwet results
gwet_data_b<-rbind(gg,hh,ii,jj,kk,ll,mm,nn,oo,pp,qq,rr,ss,tt,uu,vv)
var_names<-c("reduction_system","flake_form","completeness","platform_cortex",
"scar_directionality", "platform_morphology", "platform_lipping",
"bulb","shattered_bulb", "initiation","ventral_plan_form","cross_section_shape",
"lateral_edge_shape","flake_termination","Kombewa","distal_plan_form")
gwet_data_merged_b<-cbind(gwet_data_a,var_names) %>%
select(c(var_names,coeff.val)) %>%
mutate(assemblage_code=rep("b",times=length(var_names)),
across(where(is.numeric), ~ round(., 2))) %>%
arrange(-coeff.val)
##merge two assemblage datasets
combined_categorical_irr<-rbind(gwet_data_merged_b,
gwet_data_merged_a)
View(combined_categorical_irr)
View(gwet_data_merged_b)
##merge two assemblage datasets
combined_categorical_irr<-rbind(gwet_data_merged_b,
gwet_data_merged_a) %>%
spread(assemblage_code, coeff.val) %>%
mutate(irr_difference=abs(a-b))
View(combined_categorical_irr)
View(combined_categorical_irr)
##merge two assemblage datasets
combined_categorical_irr<-rbind(gwet_data_merged_b,
gwet_data_merged_a) %>%
filter(!var_names=="reduction_system") %>%
spread(assemblage_code, coeff.val) %>%
mutate(irr_difference=abs(a-b))
View(combined_categorical_irr)
##merge two assemblage datasets
combined_categorical_irr<-rbind(gwet_data_merged_b,
gwet_data_merged_a) %>%
#filter(!var_names=="reduction_system") %>%
spread(assemblage_code, coeff.val) %>%
mutate(irr_difference=abs(a-b))
View(combined_categorical_irr)
##merge two assemblage datasets
combined_categorical_irr<-rbind(gwet_data_merged_b,
gwet_data_merged_a) %>%
#filter(!var_names=="reduction_system") %>%
spread(assemblage_code, coeff.val) %>%
mutate(irr_difference=abs(a-b))
View(combined_categorical_irr)
ggplot(combined_categorical_irr,
aes(y=irr_difference, x=reorder(var_names,irr_difference))) +
geom_bar(position=position_dodge(), stat="identity") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.8, hjust = 0.99),
axis.text = element_text(size = 10)) +
ylab(expression(paste("IRR difference")))+
xlab(label="")+
theme(axis.title.y = element_text(face="bold"),
axis.text.x = element_text(face = "bold"))
##merge two assemblage datasets
combined_categorical_irr<-rbind(gwet_data_merged_b,
gwet_data_merged_a) %>%
#filter(!var_names=="reduction_system") %>%
spread(assemblage_code, coeff.val) %>%
mutate(irr_difference=(a-b))
ggplot(combined_categorical_irr,
aes(y=irr_difference, x=reorder(var_names,irr_difference))) +
geom_bar(position=position_dodge(), stat="identity") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.8, hjust = 0.99),
axis.text = element_text(size = 10)) +
ylab(expression(paste("IRR difference")))+
xlab(label="")+
theme(axis.title.y = element_text(face="bold"),
axis.text.x = element_text(face = "bold"))
combined_assemblage_count_data<-rbind(irr_count_data_merged_b,
irr_count_data_merged_a) %>%
spread(assemblage_code, irr) %>%
mutate(irr_difference=(a-b))
ggplot(combined_assemblage_count_data,
aes(y=irr_difference, x=reorder(var_countnames,irr_difference))) +
geom_bar(position=position_dodge(), stat="identity") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.8, hjust = 0.99),
axis.text = element_text(size = 10)) +
ylab(expression(paste("IRR difference")))+
xlab(label="")+
theme(axis.title.y = element_text(face="bold"),
axis.text.x = element_text(face = "bold"))
#### merge and compare two assemblage IRR data ####
merged_assemblage_irr_cont_data<-rbind(irr_cont_data_complete_flakeid_a,
irr_cont_data_complete_flakeid_b) %>%
select(c(var_contnames,assemblage_code,irr)) %>%
spread(assemblage_code, irr) %>%
mutate(irr_difference=(a-b))
library(ggtext)
ggplot(merged_assemblage_irr_cont_data,
aes(y=irr_difference, x=reorder(var_contnames,irr_difference))) +
geom_bar(position=position_dodge(), stat="identity") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.8, hjust = 0.99),
axis.text = element_text(size = 10)) +
ylab(expression(paste("IRR difference")))+
xlab(label="")+
theme(axis.title.y = element_text(face="bold"),
axis.text.x = element_text(face = "bold"))
View(combined_categorical_irr)
